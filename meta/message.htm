<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <title>Message - FHIR v[%version%]</title>

  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="http://hl7.org/fhir" name="author"/>

  <link rel="stylesheet" href="fhir.css"/>


    <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="./dist/css/bootstrap.css"/>
  <link rel="stylesheet" href="./assets/css/bootstrap-fhir.css"/>

    <!-- Project extras -->
  <link rel="stylesheet" href="./assets/css/project.css"/>
  <link rel="stylesheet" href="./assets/css/pygments-manni.css"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- [if lt IE 9]>
  <script src="./assets/js/html5shiv.js"></script>
  <script src="./assets/js/respond.min.js"></script>
  <![endif] -->

    <!-- Favicons -->
  <link sizes="144x144" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link sizes="114x114" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link sizes="72x72" rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="./assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="./assets/ico/favicon.png"/>

</head>
<body>
	<div id="segment-header" class="segment">  <!-- segment-header -->	
		<div class="container">  <!-- container -->
			<a id="logo" href="http://hl7.org/fhir"><img alt="logo fhir" src="./assets/images/fhir-logo-www.png"/> </a>
			
			<div id="hl7-nav">
				 <a id="hl7-logo" href="http://www.hl7.org">
					<img height="50" alt="visit the hl7 website" width="42" src="./assets/images/hl7-logo.png"/>
				</a> 
				<a alt="link to hl7 community wiki" href="http://wiki.hl7.org/index.php?title=FHIR_Message_Page">Community Input (wiki)</a> 
			</div>       	
		</div>
		<div class="container">  <!-- container -->
	</div></div>  <!-- /segment-header -->	


	<div id="segment-navbar" class="segment">  <!-- segment-navbar -->
		<div id="stripe"> </div>
		<div class="container">  <!-- container -->
   <!-- HEADER CONTENT -->
 	      		
 	      		      		
			<div class="navbar navbar-inverse">
				<div class="container">
					<button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
						<span class="icon-bar"/>
						<span class="icon-bar"/>
						<span class="icon-bar"/>
					</button>
					<a class="navbar-brand hidden" href="index.htm">FHIR</a>
					<div class="nav-collapse collapse navbar-inverse-collapse">
						<ul class="nav navbar-nav">
              <li><a href="index.htm">Home</a></li>
              <li><a href="documentation.htm">Documentation</a></li>
              <li><a href="implementation.htm">Implementation</a></li>
              <li><a href="resourcelist.htm">Resources</a></li>
              <li><a href="clinical.htm">Clinical</a></li>
              <li><a href="administration.htm">Administrative</a></li>
              <li><a href="infrastructure.htm">Infrastructure</a></li>

						</ul>
					</div>  <!-- /.nav-collapse -->
				</div>  <!-- /.container -->
			</div>  <!-- /.navbar -->
      		
				
  <!-- /HEADER CONTENT -->				
		</div>  <!-- /container -->
	</div>  <!-- /segment-navbar -->
	

	<div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
		<div class="container">  <!-- container -->	
			<ul class="breadcrumb">
        <li><a href="index.htm">Home</a></li>
        <li><a href="infrastructure.htm">Infrastructure</a></li>        <li><b>Message</b></li>
			</ul>	
		</div>  <!-- /container -->
	</div>  <!-- /segment-breadcrumb -->
	

	<div id="segment-content" class="segment">  <!-- segment-content -->
	<div class="container">  <!-- container -->
            <div class="row">
            	<div class="inner-wrapper">
  <!-- CONTENT CONTENT -->


<div class="col-9">

<div class="navtop"><ul class="navtop"><li class="spacerleft"><span>&nbsp;</span></li><li class="selected"><span>Content</span></li><li class="nselected"><span><a href="message-examples.htm">Examples</a></span></li><li class="nselected"><span><a href="message-definitions.htm">Formal Definitions</a></span></li><li class="nselected"><span><a href="message-mappings.htm">Mappings</a></span></li><li class="nselected"><span><a href="message-profiles.htm">Profiles</a></span></li><li class="spacerright"><span>&nbsp;</span></li><li class="wiki"><span><a href="http://wiki.hl7.org/index.php?title=FHIR_message_Page">Community Input (wiki)</a></span></li></ul></div>

<h1>Resource Message - Content <span class="sectioncount">6.9<a name="6.9"> </a></span></h1>
  <!-- <p class="status">Status: Approved infrastructure resource. Draft for comment</p> -->
<p>
The root for a transmission either requesting or responding to an action.  The resource(s) that are the subject of the action as well as other Information related to the action are typically transmitted in a bundle of which the Message resource instance is the first resource in the bundle.
</p>




<p>
This page describes how FHIR Resources can be used in a traditional messaging context, 
much like HL7 v2. Applications claiming conformance to this framework claim to be 
conformant to &quot;FHIR messaging&quot;. 
</p>
<p>
In FHIR messaging, a &quot;request message&quot; is sent from a source application to a destination
application when an event happens. Events mostly correspond to things that happen in the 
real world. The request message consists of a <a href="extras.htm#bundle">bundle</a>
of resources, with the first resource in the bundle being this <i>Message</i> resource. The 
Message resource has a code - the message event - that identifies the nature of the 
request message and carries additional request metadata. The other resources in the 
bundle depend on the type of the request.
</p>
<p>
The events supported in FHIR, along with the resources that are included in them, are defined below. 
</p>
<p>
The destination application processes the request and returns one or more response messages 
which are also a <a href="extras.htm#bundle">bundle</a> of resources, with the first 
resource in the bundle being a <a href="#resource">Message</a> resource with a response
section that reports the outcome of processing the message and any additional response 
resources required. 
</p>

<h2>Basic Messaging Assumptions <span class="sectioncount">6.9.1<a name="6.9.1"> </a></span></h2>

<p>
This specification assumes that content will be delivered from one application
to another by some delivery mechanism, and then a response will be returned 
to the source application. The exact mechanism of transfer is irrelevant to
this specification, but may include file transfer, http based transfer, MLLP
(HL7 minimal lower layer protocol), MQ series messaging or anything else. 
The only requirement for the transfer layer is that requests are sent to 
a known location and responses are returned to the source of the request. 
This specification considers the source and destination applications as logical
entities, and the mapping from logical source and destination to implementation
specific addresses is outside the scope of this specification.
</p>

<p>
In principle, source applications are not required to wait for a response to 
a transaction before issuing a new transaction. However in many cases, the 
messages in a given stream are dependent on each other, and must be sent and 
processed in order. In addition, some transfer methods may require sequential 
delivery of messages.
</p>

<p>
This specification ignores the existence of interface engines and message 
transfer agents that exist between the <i>source</i> and <i>destination</i>. 
Either they are transparent to the message/transaction content and irrelevant 
to this specification, or they are actively involved in manipulating the message 
content. If these middleware agents are modifying the message content, then they become
responsible for honoring the contract that applies (including applicable profiles) 
in both directions.
</p>

<h3>Message Identifiers <span class="sectioncount">6.9.1.1<a name="6.9.1.1"> </a></span></h3>
<p>
An incoming message contains two identifiers: the envelope id 
(<a href="extras.htm#bundles">feed</a>.id) and the <a href="message.htm">message</a>.identifier. 
Each time a new message is created, it must be assigned an identifier that is 
unique within that message stream. Note that since message streams are often 
merged with other streams, it is recommended that the identifier should be globally 
unique. This can be achieved by using a UUID or an OID or appropriately 
chosen URI with a serially incrementing number. Each time a message is sent, 
the bundle identifier (feed.id) should be changed to a new value. 
</p>
<p>
When a receiver receives and processes the message, it responds with a 
new message with a new identifier, wrapped in a bundle which also has a new id. 
The response message also quotes the request message identifier so that the source
system can relate the response to its request.
</p>

<a name="reliable"> </a>
<h3>Absence of Reliable Messaging <span class="sectioncount">6.9.1.2<a name="6.9.1.2"> </a></span></h3>
<p>
Some of the message delivery mechanisms mentioned above are reliable delivery
systems - the message is always delivered, or an appropriate error is returned
to the source. However most implementations use methods which do not provide
reliable messaging, and either the request or the response can get lost in transit.
FHIR messaging describes a simple approach to handle this that receivers
should conform to in order to maintain predictable functionality even when 
messaging is not reliable.
</p>
<p>
When considering the issue of reliable messaging, the source application 
should consider whether the message is a message of consequence, or 
a message of currency. A message of consequence is one where the message
requests a change that should not be processed more than once, and where
the sender needs the response that results from processing the message.
A message of currency is where the correct response is the very latest 
information available. Typically, this is status information. Some 
messages fit into neither category - the response does not particularly
matter. Usually these are notification messages.
</p>
<p>
In order to enable these processing rules, and to benefit from them, the 
original sender of the message SHALL do the following when it receives
no response to a message within a configured timeout period:
</p>
<table class="grid">
 <tr><td>Consequence</td><td>Resend the same message (including with the same identifier) with the same envelope id</td></tr>
 <tr><td>Currency</td><td>Resend the same message (including with the same identifier) with a different envelope id</td></tr>
 <tr><td>Neither</td><td>Resend the same message (including with the same identifier) with a different envelope id</td></tr>
</table>
<p>
When a receiver declares that it implements reliable answers, it SHALL check the 
incoming envelope id and message identifier against a cache of previously received messages. 
The correct action to take depends on what is received:
</p>
<table class="grid">
 <tr><td>Both the envelope id and message identifier have not been received</td><td>This is the normal case, and the message should be processed</td></tr>
 <tr><td>Both envelope and message already received</td><td>The original response has been lost (failed to return to the request issuer), and the original response must be resent</td></tr>
 <tr><td>The message identifier has already been received, but the envelope id is new</td><td>A previously seen message has been resubmitted for processing again. The server may either reprocess the message, or reject the message</td></tr>
 <tr><td>The envelope id has already been received, but the message identifier is new</td><td>This is an error - envelope ids should never be reused</td></tr>
</table>
<p>
The duration period for caching does generally not need to be very long. At a minimum, it 
could be 1 minute longer than the timeout of the sending system, though it may need to 
be longer depending on the re-sending policies of the sending system. 
</p>


<pre>
TODO: describe some use cases
</pre>

<h2>Conformance Statement <span class="sectioncount">6.9.2<a name="6.9.2"> </a></span></h2>
<p>
Applications may only claim to be conformant to &quot;FHIR messaging&quot; if they
publish a conformance statement so the claim may be verified. A conformance
statement lists all the message events 
they support (either as sender or receiver) and for each event, a 
profile that states which resources are bundled (sender), or 
are required to be bundled (receiver), and any rules about the 
information content of the individual resources. The conformance 
statement is a <a href="conformance.htm">resource with the name 
&quot;Conformance&quot;</a>. 
</p>

<a name="endpoints"/>
<h2>Messaging End-points <span class="sectioncount">6.9.3<a name="6.9.3"> </a></span></h2>

<p>There are two end-points defined for a RESTful server that supports Messages:</p>

<ul>
 <li>[baseurl]/message/: a normal RESTful end point for message resources</li> 
 <li>[baseurl]/mailbox: an address at which messages can be delivered</li> 
</ul>
<p>
The first end-point ([baseurl]/message/) is used for working within the message contents, for instance, for building 
messages piecemeal or for auditing received messages. <b>Creating or updating Message resources
to this end point does not represent the actual occurrence of any event, nor can it trigger
any logic associated with the actual event.</b> It is just for managing message resources.
</p>
<p>
The second end-point ([baseurl]/mailbox) is used for actually sending messages as <a href="extras.htm#bundle">bundles</a>, to indicate 
that the event identified by the code has occurred. The end-point responds with a message
response as defined for the particular event, or an error indicating that the attempt to 
process the message was unsuccessful. The functionality of this end-point <a href="#mailbox">is described below</a>.
</p>
<p>
Note: While the end-points above are defined for use with message resources and for delivering
messages to a RESTful server, it is not necessary to use them; messages may be transported 
between systems using any method desired.
</p>

<a name="resource"/>

<h2>
Resource Content
 <span class="sectioncount">6.9.4<a name="6.9.4"> </a></span></h2>
<a name="uml"> </a>
<svg height="382.0" width="696.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1">  <defs>
    <filter id="shadow" height="200%" width="200%" y="0" x="0">
      <feOffset result="offOut" dx="3" dy="3" in="SourceGraphic"/>
      <feColorMatrix result="matrixOut" values="0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0" type="matrix" in="offOut"/>
      <feGaussianBlur result="blurOut" stdDeviation="2" in="matrixOut"/>
      <feBlend in2="blurOut" in="SourceGraphic" mode="normal"/>
    </filter>
  </defs><rect height="176.0" style="fill:#f0f8ff;stroke:black;stroke-width:1" width="224.0" filter="url(#shadow)" rx="4" y="0.0" ry="4" x="0.0"/><line style="stroke:dimgrey;stroke-width:1" y1="28.0" y2="28.0" x2="224.0" x1="0.0"/><text fill="black" class="diagram-class-title  diagram-class-resource" y="20.0" x="112.0">Message<tspan class="diagram-class-title-link"> (<a class="diagram-class-reference" xlink:href="resources.htm">Resource</a>)</tspan></text><text fill="black" class="diagram-class-detail" y="42.0" x="6.0"><a xlink:href="message-definitions.htm#Message.identifier"><title>The identifier of this message</title>identifier</a> : <a xlink:href="datatypes.htm#id">id</a> 1..1</text><text fill="black" class="diagram-class-detail" y="56.0" x="6.0"><a xlink:href="message-definitions.htm#Message.timestamp"><title>The time that the message was sent</title>timestamp</a> : <a xlink:href="datatypes.htm#instant">instant</a> 1..1</text><text fill="black" class="diagram-class-detail" y="70.0" x="6.0"><a xlink:href="message-definitions.htm#Message.event"><title>Code that identifies the event this message represents and connects it with the event definition in the FHIR specification (this element modifies the meaning of other elements)</title>event</a> : <a xlink:href="datatypes.htm#code">code</a> 1..1 &lt;&lt;<a xlink:href="message-events.htm"><title>One of the message events defined as part of FHIR</title>MessageEvent</a>&gt;&gt;</text><text fill="black" class="diagram-class-detail" y="84.0" x="6.0"><a xlink:href="message-definitions.htm#Message.enterer"><title>The person or device that performed the data entry leading to this message. Where there is more than one candidate, pick the most proximal to the message. Can provide other enterers in extensions</title>enterer</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="practitioner.htm#Practitioner">Practitioner</a>) 0..1</text><text fill="black" class="diagram-class-detail" y="98.0" x="6.0"><a xlink:href="message-definitions.htm#Message.author"><title>The logical author of the message - the person or device that decided the described event should happen. Where there is more than one candidate, pick the most proximal to the Message. Can provide other authors in extensions</title>author</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="practitioner.htm#Practitioner">Practitioner</a>) 0..1</text><text fill="black" class="diagram-class-detail" y="112.0" x="6.0"><a xlink:href="message-definitions.htm#Message.receiver"><title>Allows data conveyed by a message to be addressed to a particular person or department when routing to a specific application isn't sufficient</title>receiver</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="practitioner.htm#Practitioner">Practitioner</a>|<a xlink:href="organization.htm#Organization">Organization</a>) 0..1</text><text fill="black" class="diagram-class-detail" y="126.0" x="6.0"><a xlink:href="message-definitions.htm#Message.responsible"><title>The person or organization that accepts overall responsibility for the contents of the Message. The implication is that the message event happened under the policies of the responsible party</title>responsible</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="practitioner.htm#Practitioner">Practitioner</a>|<a xlink:href="organization.htm#Organization">Organization</a>) 0..1</text><text fill="black" class="diagram-class-detail" y="140.0" x="6.0"><a xlink:href="message-definitions.htm#Message.effective"><title>The effective time - the real world time of the event that the message represents. Usually this is just a starting time, but some message events also have an end time (do x for period y)</title>effective</a> : <a xlink:href="datatypes.htm#Period">Period</a> 0..1</text><text fill="black" class="diagram-class-detail" y="154.0" x="6.0"><a xlink:href="message-definitions.htm#Message.reason"><title>Coded indication of the cause for the event - indicates  a reason for the occurance of the event that is a focus of this message</title>reason</a> : <a xlink:href="datatypes.htm#CodeableConcept">CodeableConcept</a> 0..1 &lt;&lt;<a xlink:href="valueset-message-reason-encounter.htm"><title>Reason for event occurrence</title>EventReason</a>&gt;&gt;</text><text fill="black" class="diagram-class-detail" y="168.0" x="6.0"><a xlink:href="message-definitions.htm#Message.data"><title>The actual data of the message - a reference to the root/focus class of the event</title>data</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="resourcelist.htm#Any">Any</a>) 0..*</text><rect height="78.0" style="fill:#f0f8ff;stroke:black;stroke-width:1" width="172.0" filter="url(#shadow)" rx="4" y="256.0" ry="4" x="26.0"/><line style="stroke:dimgrey;stroke-width:1" y1="284.0" y2="284.0" x2="198.0" x1="26.0"/><text fill="black" class="diagram-class-title" y="276.0" x="112.0">Response</text><text fill="black" class="diagram-class-detail" y="298.0" x="32.0"><a xlink:href="message-definitions.htm#Message.response.identifier"><title>The id of the message that this a response to</title>identifier</a> : <a xlink:href="datatypes.htm#id">id</a> 1..1</text><text fill="black" class="diagram-class-detail" y="312.0" x="32.0"><a xlink:href="message-definitions.htm#Message.response.code"><title>Code that identifies the type of response to the message - whether it was successful or not, and whether it should be resent or not (this element modifies the meaning of other elements)</title>code</a> : <a xlink:href="datatypes.htm#code">code</a> 1..1 &lt;&lt;<a xlink:href="response-code.htm"><title>The kind of response to a message</title>ResponseCode</a>&gt;&gt;</text><text fill="black" class="diagram-class-detail" y="326.0" x="32.0"><a xlink:href="message-definitions.htm#Message.response.details"><title>Full details of any issues found in the message</title>details</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="operationoutcome.htm#OperationOutcome">OperationOutcome</a>) 0..1</text><rect height="106.0" style="fill:#f0f8ff;stroke:black;stroke-width:1" width="96.0" filter="url(#shadow)" rx="4" y="256.0" ry="4" x="224.0"/><line style="stroke:dimgrey;stroke-width:1" y1="284.0" y2="284.0" x2="320.0" x1="224.0"/><text fill="black" class="diagram-class-title" y="276.0" x="272.0">Source</text><text fill="black" class="diagram-class-detail" y="298.0" x="230.0"><a xlink:href="message-definitions.htm#Message.source.name"><title>Human readable name for the target system</title>name</a> : <a xlink:href="datatypes.htm#string">string</a> 0..1</text><text fill="black" class="diagram-class-detail" y="312.0" x="230.0"><a xlink:href="message-definitions.htm#Message.source.software"><title>May include configuration or other information useful in debugging</title>software</a> : <a xlink:href="datatypes.htm#string">string</a> 1..1</text><text fill="black" class="diagram-class-detail" y="326.0" x="230.0"><a xlink:href="message-definitions.htm#Message.source.version"><title>Can convey versions of multiple systems in situations where a message passes through multiple hands</title>version</a> : <a xlink:href="datatypes.htm#string">string</a> 0..1</text><text fill="black" class="diagram-class-detail" y="340.0" x="230.0"><a xlink:href="message-definitions.htm#Message.source.contact"><title>An e-mail, phone, website or other contact point to use to resolve issues with message communications</title>contact</a> : <a xlink:href="datatypes.htm#Contact">Contact</a> 0..1</text><text fill="black" class="diagram-class-detail" y="354.0" x="230.0"><a xlink:href="message-definitions.htm#Message.source.endpoint"><title>Identifies the routing target to send acknowledgements to</title>endpoint</a> : <a xlink:href="datatypes.htm#uri">uri</a> 1..1</text><rect height="78.0" style="fill:#f0f8ff;stroke:black;stroke-width:1" width="128.0" filter="url(#shadow)" rx="4" y="256.0" ry="4" x="368.0"/><line style="stroke:dimgrey;stroke-width:1" y1="284.0" y2="284.0" x2="496.0" x1="368.0"/><text fill="black" class="diagram-class-title" y="276.0" x="432.0">Destination</text><text fill="black" class="diagram-class-detail" y="298.0" x="374.0"><a xlink:href="message-definitions.htm#Message.destination.name"><title>Human readable name for the source system</title>name</a> : <a xlink:href="datatypes.htm#string">string</a> 0..1</text><text fill="black" class="diagram-class-detail" y="312.0" x="374.0"><a xlink:href="message-definitions.htm#Message.destination.target"><title>Identifies the target end system in situations where the initial message transmission is to an intermediary system</title>target</a> : <a xlink:href="references.htm#Resource">Resource</a>(<a xlink:href="device.htm#Device">Device</a>) 0..1</text><text fill="black" class="diagram-class-detail" y="326.0" x="374.0"><a xlink:href="message-definitions.htm#Message.destination.endpoint"><title>Indicates where the message should be routed to</title>endpoint</a> : <a xlink:href="datatypes.htm#uri">uri</a> 1..1</text><line style="stroke:navy;stroke-width:1" y1="176.0" y2="256.0" x2="112.0" x1="112.0"/><polygon transform="rotate(90.0 112.0 176.0)" style="fill:navy;stroke:navy;stroke-width:1" points="112.0,176.0 118.0,180.0 124.0,176.0 118.0,172.0 112.0,176.0"/><rect height="18.0" style="fill:white;stroke:black;stroke-width:0" width="32.0" y="209.0" x="96.0"/><text fill="black" class="diagram-class-linkage" y="219.0" x="112.0"><a xlink:href="message-definitions.htm#Message.response"><title>Information about the message that this message is a response to.  Only present if this message is a response (this element modifies the meaning of other elements)</title>response</a></text><text fill="black" class="diagram-class-linkage" y="252.0" x="112.0">0..1</text><line style="stroke:navy;stroke-width:1" y1="176.0" y2="256.0" x2="233.62895927601807" x1="175.71040723981898"/><polygon transform="rotate(54.09614198165895 175.71040723981898 176.0)" style="fill:navy;stroke:navy;stroke-width:1" points="175.71040723981898,176.0 181.71040723981898,180.0 187.71040723981898,176.0 181.71040723981898,172.0 175.71040723981898,176.0"/><rect height="18.0" style="fill:white;stroke:black;stroke-width:0" width="24.0" y="209.0" x="192.0"/><text fill="black" class="diagram-class-linkage" y="219.0" x="204.0"><a xlink:href="message-definitions.htm#Message.source"><title>The source application from which this message originated</title>source</a></text><text fill="black" class="diagram-class-linkage" y="252.0" x="233.62895927601807">1..1</text><line style="stroke:navy;stroke-width:1" y1="160.45000000000002" y2="256.0" x2="371.71014492753625" x1="224.0"/><polygon transform="rotate(32.89781830471753 224.0 160.45000000000002)" style="fill:navy;stroke:navy;stroke-width:1" points="224.0,160.45000000000002 230.0,164.45000000000002 236.0,160.45000000000002 230.0,156.45000000000002 224.0,160.45000000000002"/><rect height="18.0" style="fill:white;stroke:black;stroke-width:0" width="44.0" y="201.0" x="275.0"/><text fill="black" class="diagram-class-linkage" y="211.0" x="297.0"><a xlink:href="message-definitions.htm#Message.destination"><title>The destination application which the message is intended for</title>destination</a></text><text fill="black" class="diagram-class-linkage" y="252.0" x="371.71014492753625">1..1</text></svg>

<a name="def"> </a>
<a name="message"> </a>
<a name="Message"> </a>
<pre class="spec">
&lt;<a title="The root for a transmission either requesting or responding to an action.  The resource(s) that are the subject of the action as well as other Information related to the action are typically transmitted in a bundle of which the Message resource instance is the first resource in the bundle." class="dict" href="message-definitions.htm#Message"><b>Message</b></a> xmlns=&quot;http://hl7.org/fhir&quot;&gt;
 &lt;!-- from <a href="resources.htm">Resource</a>: <a href="extensibility.htm">extension</a>, <a href="narrative.htm#Narrative">narrative</a>, and <a href="references.htm#contained">contained</a> --&gt;
 &lt;<a title="The identifier of this message." class="dict" href="message-definitions.htm#Message.identifier"><b>identifier</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#id">id</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Id of this message</span><span style="color: Gray"> --&gt;</span>
 &lt;<a title="The time that the message was sent." class="dict" href="message-definitions.htm#Message.timestamp"><b>timestamp</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#instant">instant</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Time that the message was sent</span><span style="color: Gray"> --&gt;</span>
 &lt;<a title="Code that identifies the event this message represents and connects it with the event definition in the FHIR specification (this element modifies the meaning of other elements)" class="dict" href="message-definitions.htm#Message.event"><span style="text-decoration: underline"><b>event</b></span></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#code">code</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy"><a style="color: navy" href="message-events.htm">Code for the event this message represents</a></span><span style="color: Gray"> --&gt;</span>
 &lt;<a title="Information about the message that this message is a response to.  Only present if this message is a response (this element modifies the meaning of other elements)" class="dict" href="message-definitions.htm#Message.response"><span style="text-decoration: underline"><b>response</b></span></a>&gt;  <span style="color: Gray">&lt;!-- <span style="color: brown"><b>0..1</b></span> If this is a reply to prior message --&gt;</span>
  &lt;<a title="The id of the message that this a response to." class="dict" href="message-definitions.htm#Message.response.identifier"><b>identifier</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#id">id</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Id of original message</span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="Code that identifies the type of response to the message - whether it was successful or not, and whether it should be resent or not (this element modifies the meaning of other elements)" class="dict" href="message-definitions.htm#Message.response.code"><span style="text-decoration: underline"><b>code</b></span></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#code">code</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy"><a style="color: navy" href="response-code.htm">Type of response to the message</a></span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="Full details of any issues found in the message." class="dict" href="message-definitions.htm#Message.response.details"><b>details</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="operationoutcome.htm#OperationOutcome">OperationOutcome</a>)</span> <span style="color: navy">Specific list of hints/warnings/errors</span><span style="color: Gray"> --&gt;</span>&lt;/details&gt;
 &lt;/response&gt;
 &lt;<a title="The source application from which this message originated." class="dict" href="message-definitions.htm#Message.source"><b>source</b></a>&gt;  <span style="color: Gray">&lt;!-- <span style="color: brown"><b>1..1</b></span> Message Source Application --&gt;</span>
  &lt;<a title="Human readable name for the target system." class="dict" href="message-definitions.htm#Message.source.name"><b>name</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#string">string</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: navy">Name of system</span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="May include configuration or other information useful in debugging." class="dict" href="message-definitions.htm#Message.source.software"><b>software</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#string">string</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Name of software running the system</span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="Can convey versions of multiple systems in situations where a message passes through multiple hands." class="dict" href="message-definitions.htm#Message.source.version"><b>version</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#string">string</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: navy">Version of software running</span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="An e-mail, phone, website or other contact point to use to resolve issues with message communications." class="dict" href="message-definitions.htm#Message.source.contact"><b>contact</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="datatypes.htm#Contact">Contact</a></span> <span style="color: navy">Human contact for problems</span><span style="color: Gray"> --&gt;</span>&lt;/contact&gt;
  &lt;<a title="Identifies the routing target to send acknowledgements to." class="dict" href="message-definitions.htm#Message.source.endpoint"><b>endpoint</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#uri">uri</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Actual message source address or id</span><span style="color: Gray"> --&gt;</span>
 &lt;/source&gt;
 &lt;<a title="The destination application which the message is intended for." class="dict" href="message-definitions.htm#Message.destination"><b>destination</b></a>&gt;  <span style="color: Gray">&lt;!-- <span style="color: brown"><b>1..1</b></span> Message Destination Application --&gt;</span>
  &lt;<a title="Human readable name for the source system." class="dict" href="message-definitions.htm#Message.destination.name"><b>name</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#string">string</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: navy">Name of system</span><span style="color: Gray"> --&gt;</span>
  &lt;<a title="Identifies the target end system in situations where the initial message transmission is to an intermediary system." class="dict" href="message-definitions.htm#Message.destination.target"><b>target</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="device.htm#Device">Device</a>)</span> <span style="color: navy">Particular delivery destination within the destination</span><span style="color: Gray"> --&gt;</span>&lt;/target&gt;
  &lt;<a title="Indicates where the message should be routed to." class="dict" href="message-definitions.htm#Message.destination.endpoint"><b>endpoint</b></a> value=&quot;[<span style="color: darkgreen"><a href="datatypes.htm#uri">uri</a></span>]&quot;/&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>1..1</b></span> <span style="color: navy">Actual destination address or id</span><span style="color: Gray"> --&gt;</span>
 &lt;/destination&gt;
 &lt;<a title="The person or device that performed the data entry leading to this message. Where there is more than one candidate, pick the most proximal to the message. Can provide other enterers in extensions." class="dict" href="message-definitions.htm#Message.enterer"><b>enterer</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="practitioner.htm#Practitioner">Practitioner</a>)</span> <span style="color: navy">The source of the data entry</span><span style="color: Gray"> --&gt;</span>&lt;/enterer&gt;
 &lt;<a title="The logical author of the message - the person or device that decided the described event should happen. Where there is more than one candidate, pick the most proximal to the Message. Can provide other authors in extensions." class="dict" href="message-definitions.htm#Message.author"><b>author</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="practitioner.htm#Practitioner">Practitioner</a>)</span> <span style="color: navy">The source of the decision</span><span style="color: Gray"> --&gt;</span>&lt;/author&gt;
 &lt;<a title="Allows data conveyed by a message to be addressed to a particular person or department when routing to a specific application isn't sufficient." class="dict" href="message-definitions.htm#Message.receiver"><b>receiver</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="practitioner.htm#Practitioner">Practitioner</a>|<a href="organization.htm#Organization">Organization</a>)</span> <span style="color: navy">Intended &quot;real-world&quot; recipient for the data</span><span style="color: Gray"> --&gt;</span>&lt;/receiver&gt;
 &lt;<a title="The person or organization that accepts overall responsibility for the contents of the Message. The implication is that the message event happened under the policies of the responsible party." class="dict" href="message-definitions.htm#Message.responsible"><b>responsible</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="practitioner.htm#Practitioner">Practitioner</a>|<a href="organization.htm#Organization">Organization</a>)</span> <span style="color: navy">Final responsibility for event</span><span style="color: Gray"> --&gt;</span>&lt;/responsible&gt;
 &lt;<a title="The effective time - the real world time of the event that the message represents. Usually this is just a starting time, but some message events also have an end time (do x for period y)." class="dict" href="message-definitions.htm#Message.effective"><b>effective</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="datatypes.htm#Period">Period</a></span> <span style="color: navy">Time of effect</span><span style="color: Gray"> --&gt;</span>&lt;/effective&gt;
 &lt;<a title="Coded indication of the cause for the event - indicates  a reason for the occurance of the event that is a focus of this message." class="dict" href="message-definitions.htm#Message.reason"><b>reason</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..1</b></span> <span style="color: darkgreen"><a href="datatypes.htm#CodeableConcept">CodeableConcept</a></span> <span style="color: navy"><a style="color: navy" href="valueset-message-reason-encounter.htm">Cause of event</a></span><span style="color: Gray"> --&gt;</span>&lt;/reason&gt;
 &lt;<a title="The actual data of the message - a reference to the root/focus class of the event." class="dict" href="message-definitions.htm#Message.data"><b>data</b></a>&gt;<span style="color: Gray">&lt;!--</span> <span style="color: brown"><b>0..*</b></span> <span style="color: darkgreen"><a href="references.htm#Resource">Resource</a>(<a href="resourcelist.htm">Any</a>)</span> <span style="color: navy">The actual content of the message</span><span style="color: Gray"> --&gt;</span>&lt;/data&gt;
&lt;/Message&gt;
</pre>


<p>Alternate definitions: <a href="message.xsd">Schema</a>/<a href="message.sch">Schematron</a>, 
<a href="message.profile.xml.htm">Resource Profile</a></p>

<a name="tx"> </a>
<h3>
Terminology Bindings
 <span class="sectioncount">6.9.4.1<a name="6.9.4.1"> </a></span></h3>
<table class="grid">
 <tr><th>Path</th><th>Definition</th><th>Type</th><th>Reference</th></tr>
 <tr><td title="MessageEvent" valign="top">Message.event </td><td valign="top">One of the message events defined as part of FHIR</td><td><a href="terminologies.htm#codeable">Incomplete</a></td><td valign="top"><a href="message-events.htm">http://hl7.org/fhir/message-events</a></td> </tr>
 <tr><td title="ResponseCode" valign="top">Message.response.code </td><td valign="top">The kind of response to a message</td><td><a href="terminologies.htm#code">Fixed</a></td><td valign="top"><a href="response-code.htm">http://hl7.org/fhir/response-code</a></td> </tr>
 <tr><td title="EventReason" valign="top">Message.reason </td><td valign="top">Reason for event occurrence</td><td><a href="terminologies.htm#example">Example</a></td><td valign="top"><a href="valueset-message-reason-encounter.htm">http://hl7.org/fhir/vs/message-reason-encounter</a></td> </tr>
</table>
<p> </p>





<h2>
Notes:
 <span class="sectioncount">6.9.5<a name="6.9.5"> </a></span></h2>
<ul>
<li>The resources referenced by the enterer, author and responsible elements may 
  all be included in the bundle or left out on the basis that the recipient (and any intermediaries) are able to locate/resolve the resources
  independently. The former would be suitable for loosely coupled systems, and the latter for tightly coupled systems. The messaging conformance 
  statement for an application may reference <a href="profile.htm">a profile</a> that describes how the bundling occurs</li>
<li>The actual content of the data resource is specified for each message event. The data resource is always included in the bundle</li>
</ul>  

<a name="Events"/>
<a name="events"/>
<h2>Event List <span class="sectioncount">6.9.6<a name="6.9.6"> </a></span></h2>

<p>
The <i>message.code</i> element carries a simple code that identifies the even that the message conveys. 
This table lists the codes that are allowed to be used in a message event:
</p>

<table class="grid">
 <tr><th>Code</th><th>Description</th><th>Request</th><th>Response</th><th>Notes</th></tr>
 <tr><td>MedicationAdministration-Complete</td><td>Change the status of a Medication Administration to show that it is complete.</td><td>MedicationAdministration</td><td>MedicationAdministration</td><td/></tr>
 <tr><td>MedicationAdministration-Nullification</td><td>Someone wishes to record that the record of administration of a medication is in error and should be ignored.</td><td>MedicationAdministration</td><td>MedicationAdministration</td><td/></tr>
 <tr><td>MedicationAdministration-Recording</td><td>Indicates that a medication has been recorded against the patient's record.</td><td>MedicationAdministration</td><td>MedicationAdministration</td><td/></tr>
 <tr><td>MedicationAdministration-Update</td><td>Update a Medication Administration record.</td><td>MedicationAdministration</td><td>MedicationAdministration</td><td/></tr>
 <tr><td rowspan="3">admin-notify</td><td rowspan="3">Notification of a change to an administrative resource (either create or update). Note that there is no delete, though some administrative resources have status or period elements for this use.</td><td>Device</td><td><font color="silver">--</font></td><td/></tr>
 <tr><td>Device</td><td><font color="silver">--</font></td><td/></tr>
 <tr><td>Group</td><td><font color="silver">--</font></td><td/></tr>
 <tr><td>diagnosticreport-provide</td><td>Provide a diagnostic report, or update a previously provided diagnostic report.</td><td>DiagnosticReport<br/>&nbsp;DiagnosticReport.patient<br/>&nbsp;DiagnosticReport.perfomer<br/>&nbsp;DiagnosticReport.results.specimen<br/>&nbsp;DiagnosticReport.results.result<br/>&nbsp;DiagnosticReport.image</td><td><font color="silver">--</font></td><td/></tr>
 <tr><td>observation-provide</td><td>Provide a simple observation or update a previously provided simple observation.</td><td>Observation<br/>&nbsp;Observation.subjectPatient<br/>&nbsp;Observation.subjectPatient.person<br/>&nbsp;Observation.subjectGroup<br/>&nbsp;Observation.subjectDevice<br/>&nbsp;Observation.subjectAnimal<br/>&nbsp;Observation.performerAgent<br/>&nbsp;Observation.performerAgent.person<br/>&nbsp;Observation.performerPatient<br/>&nbsp;Observation.performerPerson</td><td><font color="silver">--</font></td><td/></tr>
 <tr><td>query</td><td>Request to perform a query according to the attached query resource.</td><td>query</td><td>query</td><td/></tr>
 <tr><td>query-response</td><td>Response with the result of processing the query.</td><td>query</td><td><font color="silver">--</font></td><td>Used when queries are performed asynchronously</td></tr>
</table>


<p>
In this table, the request and response columns list the focus resource for the event, along with other resources that should also be carried in the message directly (if they exist).
Open Issue for ballot: Does this list need to be extensible? 
</p>

<a name="mailbox"/>
<h2>Mailbox <span class="sectioncount">6.9.7<a name="6.9.7"> </a></span></h2>
<p>
The mailbox is the standard name for a service hosted on a RESTful server that accepts messages and processes 
them as transactions and returns a message response appropriate for the message received. The server is under
no obligation to do anything particular with the resources except as required by the semantics of the event code in the 
message resource. A server may choose to retain the resources and make them available on a RESTful interface, but 
is not required to do so. If the server returns 200 Ok, it must return a valid message that indicates what the outcome
of the event processing is. An HTTP error indicates that the message was not processed successfully and that it should
be resubmitted (and doing so should not result in a duplicate message response).  Repeated failures indicate either a
fatal problem with the message or a problem with the receiving application.
</p>
<p>
The mailbox can also be used to accept documents. In this case, the document is &quot;accepted&quot; (the server 
takes responsibility for custody of the received document) and an HTTP status of 204 No Content is returned, 
or an HTTP error is returned. The server is under no obligation to do anything with the document except as 
specific trading partner agreements dictate.
</p>
<p>
The following rules apply to the mailbox:
</p>
<ul>
 <li>The mailbox only accepts POST transactions - any other HTTP method will result in an HTTP error</li>
 <li>The request content type submitted is always <a href="extras.htm#bundle">a bundle</a> containing a message or document resource as the first resource</li>
 <li>The response content type returned is always an HTTP error, <a href="extras.htm#bundle">a bundle</a> containing a message as the first resource, or empty (if a document was received)</li>
 <li>If the response is an error, the body SHOULD be an <a href="operationoutcome.htm">Errors &amp; Warning</a> resource with full details</li> 
 <li>The URL never takes any parameters</li>
 <li>The mailbox may be authenticated using standard HTTP authentication methods, including OAuth</li>
</ul>
<p>
This simple mailbox profile can be used by any HTTP end point that accepts FHIR messages or documents, not just 
FHIR RESTful servers.
</p>
<p>
In order to ensure consistency of processing, the <a href="#reliable">logical rules regarding processing of envelope id and 
message id described above</a> SHALL be followed when messages are processed using the mailbox. No such rules apply regarding
documents - if the client receives no response, it should continue to submit the document until it does. Servers SHALL 
accept multiple document submissions and process them correctly.
</p>



<a name="search"> </a>
<h2>Search Parameters <span class="sectioncount">6.9.8<a name="6.9.8"> </a></span></h2>
<p>Search Parameters for RESTful searches. The standard parameters also apply. See <a href="query.htm#base">Searching</a> for more information.</p>
<table class="list">
<tr><td><b>Name / Type</b></td><td><b>Description</b></td><td><b>Paths</b></td></tr>
<tr><td>_id : token</td><td>The logical resource id associated with the resource (must be supported by all servers)</td><td/></tr>
</table>



</div>


				</div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->
    </div>  <!-- /segment-content -->


	<div id="segment-footer" class="segment">  <!-- segment-footer -->
		<div class="container">  <!-- container -->
			<div class="inner-wrapper">
				<p>
        &copy; HL7.org 2011 - 2013. FHIR v0.11-1711 generated on Tue, Aug 13, 2013 07:57+1000. <a href="license.htm">License</a>. <a href="qa.htm">QA Report</a>
        <br/>
        <span style="color: #FFFF77">
        Warning: This version of FHIR is the <a href="ballot-intro.htm">DSTU ballot</a>, and the stable version for the September/October connectathons. 
        Implementers are welcome to experiment with the content defined here, but should note that the contents are subject to change without prior notice.
        </span>
        </p>
			</div>  <!-- /inner-wrapper -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-footer -->
	
	<div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
		<div class="container">  <!-- container -->
		</div>  <!-- /container -->
	</div>  <!-- /segment-post-footer -->
    
      <!-- JS and analytics only. -->
      <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.js"/>
<script src="./dist/js/bootstrap.min.js"/>
<script src="./assets/js/respond.min.js"/>

<script src="./assets/js/fhir.js"/>

  <!-- Analytics Below
================================================== -->

    
</body>
</html>